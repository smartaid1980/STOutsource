dateFormat(oriCol(A), "/") ###日期(A)
split(oriCol(A), "/", 0) ###年(B)
stringcat("M", split(oriCol(A), "/", 1)) ###月(C)
map( add(split(oriCol(A), "/", 1), 0),"quarter",true) ###季(D)
stringcat("W", map(newCol(A), stringcat("week",newCol(B)), false)) ###週(E)
oriCol(D) ###班次(F)
substring(map(oriCol(D), "scheduleTime", true), 0, 2) ###起(G)
substring(map(oriCol(D), "scheduleTime", true), 3, 5) ###迄(H)
oriCol(E) ###機台(I)
oriCol(G) ###產品類型(殼別)(J)
oriCol(F) ###產品名稱(機型名稱、公司編號)(K)
oriCol(H) ###工單數量(L)
char(0) ###模號(M)
if(oriCol(I)="",0,oriCol(I)) ###實際數量(加總用)(N)
if(oriCol(I)="",newCol(O, -1),oriCol(I)) ###實際數量(算不良率用)(O)若實際數量為空則取上一筆之本欄
char(0) ###不良代碼(P)
if(oriCol(J)="",0,oriCol(J)) ###不良數(Q)
char(0) ###生產不良說明(R)
oriCol(K) ###製程代號(S)
if(oriCol(K)="", "無製程", map(oriCol(K), "process", true)) ###製程(T)
if(oriCol(M)="",0,division(map(stringcat(oriCol(K),"@@",oriCol(F)),"standardWorkHours",true),60,false)) ###單件標工(U)
if(oriCol(N)="",0, product(newCol(U),sub(oriCol(I), oriCol(J)))) ###總標工(V)(數量-不良數)*單件標工
if(oriCol(O)="",0,oriCol(O)) ###投入人數(W)
if(oriCol(P)="",0,oriCol(P)) ###投入時間(X)
product(oriCol(O),oriCol(P)) ###起迄時間總投入人時(Y)
oriCol(Q) ###開機數(Z)
oriCol(S) ###無效代碼(AA)
if(oriCol(S)="","無無效代碼",map(oriCol(S),"errorNum",true)) ###無效說明(AB)
if(oriCol(S)="","N",map(oriCol(S), "isChangeLine", true)) ###是否換線(AC)
if(oriCol(U)="", 0, oriCol(U)) ###無效人數(AD)
if(oriCol(V)="", 0, oriCol(V)) ###無效時間(AE)
product(oriCol(U),oriCol(V)) ###無效人時(AF)
